var Q=Object.defineProperty;var Y=(i,e,t)=>e in i?Q(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var o=(i,e,t)=>Y(i,typeof e!="symbol"?e+"":e,t);import{A as X,u as a,X as L,b as $,M as D,D as Z,G as F,K as ee,H as te,S as se,h as b,a as N,C as V,c as ae,P as ne,d as M,e as re,f as ie,B as oe}from"./local_storage-Cd3GnYkn.js";function f(i){return e=>{const t=e.currentTarget,s=t.type==="checkbox"?t.checked:t.value;i(s)}}function _(i){const e=X(null);function t(s){var n,r;if(s.key===","||s.key==="Enter"){s.preventDefault();const c=(n=e.current)==null?void 0:n.value.trim();c&&(i.onChange([...i.tags,c]),e.current.value="")}else s.key==="Backspace"&&((r=e.current)==null?void 0:r.value)===""&&i.onChange(i.tags.slice(0,-1))}return a($,{children:[a("div",{class:"tag-input input-in-table",tabIndex:-1,onClick:()=>{var s;return(s=e.current)==null?void 0:s.focus()},children:[i.tags.map((s,n)=>a("span",{class:"tag",children:[s," ",a(L,{size:24,color:"rgba(255, 255, 255, 0.5)",onClick:()=>i.onChange(i.tags.filter((r,c)=>c!==n))})]},n)),a("input",{ref:e,class:"textbox",type:"text",onKeyDown:t})]}),a("small",{class:"input-in-table",children:["Pressione ",a("span",{class:"shortcut",children:","})," ou ",a("span",{class:"shortcut",children:"Enter"})," para incluir um novo elemento."]})]})}function ce(i){const{equipe:e,setEquipe:t}=i;return a($,{children:[a("h3",{children:"Equipe"}),a("table",{class:"striped",children:[a("thead",{children:a("tr",{children:[a("th",{width:240,scope:"col",children:"Função"}),a("th",{scope:"col",children:"Nome"})]})}),a("tbody",{children:[a("tr",{children:[a("td",{children:[a(D,{size:24})," Lead"]}),a("td",{children:a("input",{class:"input-in-table",type:"text",value:e.lead,onInput:f(s=>t({...e,lead:s}))})})]}),a("tr",{children:[a("td",{children:[a(D,{size:24})," Backs"]}),a("td",{children:a(_,{tags:e.backs,onChange:s=>t({...e,backs:s})})})]}),a("tr",{children:[a("td",{children:[a(Z,{size:24})," Bateria"]}),a("td",{children:a("input",{class:"input-in-table",type:"text",value:e.bateria,onInput:f(s=>t({...e,bateria:s}))})})]}),a("tr",{children:[a("td",{children:[a(F,{size:24})," Baixo"]}),a("td",{children:a("input",{class:"input-in-table",type:"text",value:e.baixo,onInput:f(s=>t({...e,baixo:s}))})})]}),a("tr",{children:[a("td",{children:[a(F,{size:24})," Guitarra"]}),a("td",{children:a("input",{class:"input-in-table",type:"text",value:e.guitarra,onInput:f(s=>t({...e,guitarra:s}))})})]}),a("tr",{children:[a("td",{children:[a(F,{size:24})," Violão"]}),a("td",{children:a("input",{class:"input-in-table",type:"text",value:e.violao,onInput:f(s=>t({...e,violao:s}))})})]}),a("tr",{children:[a("td",{children:[a(ee,{size:24})," Teclado"]}),a("td",{children:a("input",{class:"input-in-table",type:"text",value:e.teclado,onInput:f(s=>t({...e,teclado:s}))})})]}),a("tr",{children:[a("td",{children:[a(te,{size:24})," DM"]}),a("td",{children:a("input",{class:"input-in-table",type:"text",value:e.dm,onInput:f(s=>t({...e,dm:s}))})})]}),a("tr",{children:[a("td",{children:[a(se,{size:24})," Técnicos de Áudio"]}),a("td",{children:a(_,{tags:e.tecnicosAudio,onChange:s=>t({...e,tecnicosAudio:s})})})]})]})]})]})}const m=[];for(let i=0;i<256;++i)m.push((i+256).toString(16).slice(1));function le(i,e=0){return(m[i[e+0]]+m[i[e+1]]+m[i[e+2]]+m[i[e+3]]+"-"+m[i[e+4]]+m[i[e+5]]+"-"+m[i[e+6]]+m[i[e+7]]+"-"+m[i[e+8]]+m[i[e+9]]+"-"+m[i[e+10]]+m[i[e+11]]+m[i[e+12]]+m[i[e+13]]+m[i[e+14]]+m[i[e+15]]).toLowerCase()}let A;const he=new Uint8Array(16);function ue(){if(!A){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");A=crypto.getRandomValues.bind(crypto)}return A(he)}const pe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),O={randomUUID:pe};function G(i,e,t){if(O.randomUUID&&!e&&!i)return O.randomUUID();i=i||{};const s=i.random||(i.rng||ue)();return s[6]=s[6]&15|64,s[8]=s[8]&63|128,le(s)}class u{constructor(e){o(this,"api");this.api=e}async getRequest(e){return await this.api.makeRequest("GET",e)}async postRequest(e,t,s=void 0){return await this.api.makeRequest("POST",e,t,s)}async putRequest(e,t,s=void 0){return await this.api.makeRequest("PUT",e,t,s)}async deleteRequest(e,t){return await this.api.makeRequest("DELETE",e,t)}paramsFor(e){const t=new URLSearchParams;for(let s of Object.getOwnPropertyNames(e))(e[s]||e[s]===0||!e[s]&&typeof e[s]=="boolean")&&t.append(s,e[s].toString());return[...t].length>0?`?${t.toString()}`:""}}class de extends u{async get(e,t){if(typeof e=="string"){const r=this.paramsFor({market:t});return await this.getRequest(`albums/${e}${r}`)}const s=this.paramsFor({ids:e,market:t});return(await this.getRequest(`albums${s}`)).albums}tracks(e,t,s,n){const r=this.paramsFor({market:t,limit:s,offset:n});return this.getRequest(`albums/${e}/tracks${r}`)}}class me extends u{async get(e){if(typeof e=="string")return this.getRequest(`artists/${e}`);const t=this.paramsFor({ids:e});return(await this.getRequest(`artists${t}`)).artists}albums(e,t,s,n,r){const c=this.paramsFor({include_groups:t,market:s,limit:n,offset:r});return this.getRequest(`artists/${e}/albums${c}`)}topTracks(e,t){const s=this.paramsFor({market:t});return this.getRequest(`artists/${e}/top-tracks${s}`)}relatedArtists(e){return this.getRequest(`artists/${e}/related-artists`)}}class ge extends u{async get(e,t){if(typeof e=="string"){const r=this.paramsFor({market:t});return this.getRequest(`audiobooks/${e}${r}`)}const s=this.paramsFor({ids:e,market:t});return(await this.getRequest(`audiobooks${s}`)).audiobooks}getAudiobookChapters(e,t,s,n){const r=this.paramsFor({market:t,limit:s,offset:n});return this.getRequest(`audiobooks/${e}/chapters${r}`)}}class ye extends u{getCategories(e,t,s,n){const r=this.paramsFor({country:e,locale:t,limit:s,offset:n});return this.getRequest(`browse/categories${r}`)}getCategory(e,t,s){const n=this.paramsFor({country:t,locale:s});return this.getRequest(`browse/categories/${e}${n}`)}getNewReleases(e,t,s){const n=this.paramsFor({country:e,limit:t,offset:s});return this.getRequest(`browse/new-releases${n}`)}getFeaturedPlaylists(e,t,s,n,r){const c=this.paramsFor({country:e,locale:t,timestamp:s,limit:n,offset:r});return this.getRequest(`browse/featured-playlists${c}`)}getPlaylistsForCategory(e,t,s,n){const r=this.paramsFor({country:t,limit:s,offset:n});return this.getRequest(`browse/categories/${e}/playlists${r}`)}}class fe extends u{async get(e,t){if(typeof e=="string"){const r=this.paramsFor({market:t});return this.getRequest(`chapters/${e}${r}`)}const s=this.paramsFor({ids:e,market:t});return(await this.getRequest(`chapters${s}`)).chapters}}class we extends u{async get(e,t){if(typeof e=="string"){const r=this.paramsFor({market:t});return this.getRequest(`episodes/${e}${r}`)}const s=this.paramsFor({ids:e,market:t});return(await this.getRequest(`episodes${s}`)).episodes}}class ke extends u{get(e){const t=this.paramsFor(e);return this.getRequest(`recommendations${t}`)}genreSeeds(){return this.getRequest("recommendations/available-genre-seeds")}}class be extends u{getAvailableMarkets(){return this.getRequest("markets")}}class Re extends u{getPlaybackState(e,t){const s=this.paramsFor({market:e,additional_types:t});return this.getRequest(`me/player${s}`)}getAvailableDevices(){return this.getRequest("me/player/devices")}getCurrentlyPlayingTrack(e,t){const s=this.paramsFor({market:e,additional_types:t});return this.getRequest(`me/player/currently-playing${s}`)}getRecentlyPlayedTracks(e,t){const s={limit:e};t&&(t.type==="before"?s.before=t.timestamp:t.type==="after"&&(s.after=t.timestamp));const n=this.paramsFor(s);return this.getRequest(`me/player/recently-played${n}`)}getUsersQueue(){return this.getRequest("me/player/queue")}async transferPlayback(e,t){if(e.length>1)throw new Error("Although an array is accepted, only a single device_id is currently supported. Supplying more than one will return 400 Bad Request");await this.putRequest("me/player",{device_ids:e,play:t})}async startResumePlayback(e,t,s,n,r){const c=this.paramsFor({device_id:e});await this.putRequest(`me/player/play${c}`,{context_uri:t,uris:s,offset:n,positionMs:r})}async pausePlayback(e){const t=this.paramsFor({device_id:e});await this.putRequest(`me/player/pause${t}`)}async skipToNext(e){const t=this.paramsFor({device_id:e});await this.postRequest(`me/player/next${t}`)}async skipToPrevious(e){const t=this.paramsFor({device_id:e});await this.postRequest(`me/player/previous${t}`)}async seekToPosition(e,t){const s=this.paramsFor({position_ms:e,device_id:t});await this.putRequest(`me/player/seek${s}`)}async setRepeatMode(e,t){const s=this.paramsFor({state:e,device_id:t});await this.putRequest(`me/player/repeat${s}`)}async setPlaybackVolume(e,t){const s=this.paramsFor({volume_percent:e,device_id:t});await this.putRequest(`me/player/volume${s}`)}async togglePlaybackShuffle(e,t){const s=this.paramsFor({state:e,device_id:t});await this.putRequest(`me/player/shuffle${s}`)}async addItemToPlaybackQueue(e,t){const s=this.paramsFor({uri:e,device_id:t});await this.postRequest(`me/player/queue${s}`)}}class Ce extends u{getPlaylist(e,t,s,n){const r=this.paramsFor({market:t,fields:s,additional_types:n==null?void 0:n.join(",")});return this.getRequest(`playlists/${e}${r}`)}getPlaylistItems(e,t,s,n,r,c){const d=this.paramsFor({market:t,fields:s,limit:n,offset:r,additional_types:c==null?void 0:c.join(",")});return this.getRequest(`playlists/${e}/tracks${d}`)}async changePlaylistDetails(e,t){await this.putRequest(`playlists/${e}`,t)}movePlaylistItems(e,t,s,n){return this.updatePlaylistItems(e,{range_start:t,range_length:s,insert_before:n})}updatePlaylistItems(e,t){return this.putRequest(`playlists/${e}/tracks`,t)}async addItemsToPlaylist(e,t,s){await this.postRequest(`playlists/${e}/tracks`,{position:s,uris:t})}async removeItemsFromPlaylist(e,t){await this.deleteRequest(`playlists/${e}/tracks`,t)}getUsersPlaylists(e,t,s){const n=this.paramsFor({limit:t,offset:s});return this.getRequest(`users/${e}/playlists${n}`)}createPlaylist(e,t){return this.postRequest(`users/${e}/playlists`,t)}getPlaylistCoverImage(e){return this.getRequest(`playlists/${e}/images`)}async addCustomPlaylistCoverImage(e,t){let s="";if(t instanceof Buffer)s=t.toString("base64");else if(t instanceof HTMLCanvasElement)s=t.toDataURL("image/jpeg").split(";base64,")[1];else if(t instanceof HTMLImageElement){const n=document.createElement("canvas");n.width=t.width,n.height=t.height;const r=n.getContext("2d");if(!r)throw new Error("Could not get canvas context");r.drawImage(t,0,0),s=n.toDataURL("image/jpeg").split(";base64,")[1]}else if(typeof t=="string")s=t;else throw new Error("ImageData must be a Buffer, HTMLImageElement, HTMLCanvasElement, or string containing a base64 encoded jpeg");await this.addCustomPlaylistCoverImageFromBase64String(e,s)}async addCustomPlaylistCoverImageFromBase64String(e,t){await this.putRequest(`playlists/${e}/images`,t,"image/jpeg")}}class ve extends u{async execute(e,t,s,n,r,c){const d=this.paramsFor({q:e,type:t,market:s,limit:n,offset:r,include_external:c});return await this.getRequest(`search${d}`)}}class xe extends u{async get(e,t){if(typeof e=="string"){const r=this.paramsFor({market:t});return this.getRequest(`shows/${e}${r}`)}const s=this.paramsFor({ids:e,market:t});return(await this.getRequest(`shows${s}`)).shows}episodes(e,t,s,n){const r=this.paramsFor({market:t,limit:s,offset:n});return this.getRequest(`shows/${e}/episodes${r}`)}}class Se extends u{async get(e,t){if(typeof e=="string"){const r=this.paramsFor({market:t});return this.getRequest(`tracks/${e}${r}`)}const s=this.paramsFor({ids:e,market:t});return(await this.getRequest(`tracks${s}`)).tracks}async audioFeatures(e){if(typeof e=="string")return this.getRequest(`audio-features/${e}`);const t=this.paramsFor({ids:e});return(await this.getRequest(`audio-features${t}`)).audio_features}audioAnalysis(e){return this.getRequest(`audio-analysis/${e}`)}}const P={access_token:"emptyAccessToken",token_type:"",expires_in:0,refresh_token:"",expires:-1};function q(i){return i===P}class qe extends u{profile(e){return this.getRequest(`users/${e}`)}}class Te extends u{constructor(t){super(t);o(this,"albums");o(this,"audiobooks");o(this,"episodes");o(this,"playlists");o(this,"shows");o(this,"tracks");this.albums=new $e(t),this.audiobooks=new Fe(t),this.episodes=new Ae(t),this.playlists=new Ee(t),this.shows=new Ue(t),this.tracks=new Ie(t)}profile(){return this.getRequest("me")}topItems(t,s,n,r){const c=this.paramsFor({time_range:s,limit:n,offset:r});return this.getRequest(`me/top/${t}${c}`)}followedArtists(t,s){const n=this.paramsFor({type:"artist",after:t,limit:s});return this.getRequest(`me/following${n}`)}async followArtistsOrUsers(t,s){const n=this.paramsFor({type:s});await this.putRequest(`me/following${n}`,{ids:t})}async unfollowArtistsOrUsers(t,s){const n=this.paramsFor({type:s});await this.deleteRequest(`me/following${n}`,{ids:t})}followsArtistsOrUsers(t,s){const n=this.paramsFor({ids:t,type:s});return this.getRequest(`me/following/contains${n}`)}}class $e extends u{savedAlbums(e,t,s){const n=this.paramsFor({limit:e,offset:t,market:s});return this.getRequest(`me/albums${n}`)}async saveAlbums(e){await this.putRequest("me/albums",e)}async removeSavedAlbums(e){await this.deleteRequest("me/albums",e)}hasSavedAlbums(e){const t=this.paramsFor({ids:e});return this.getRequest(`me/albums/contains${t}`)}}class Fe extends u{savedAudiobooks(e,t){const s=this.paramsFor({limit:e,offset:t});return this.getRequest(`me/audiobooks${s}`)}async saveAudiobooks(e){await this.putRequest("me/audiobooks",e)}async removeSavedAudiobooks(e){await this.deleteRequest("me/audiobooks",e)}hasSavedAudiobooks(e){const t=this.paramsFor({ids:e});return this.getRequest(`me/audiobooks/contains${t}`)}}class Ae extends u{savedEpisodes(e,t,s){const n=this.paramsFor({market:e,limit:t,offset:s});return this.getRequest(`me/episodes${n}`)}async saveEpisodes(e){await this.putRequest("me/episodes",e)}async removeSavedEpisodes(e){await this.deleteRequest("me/episodes",e)}hasSavedEpisodes(e){const t=this.paramsFor({ids:e});return this.getRequest(`me/episodes/contains${t}`)}}class Ee extends u{playlists(e,t){const s=this.paramsFor({limit:e,offset:t});return this.getRequest(`me/playlists${s}`)}async follow(e){await this.putRequest(`playlists/${e}/followers`)}async unfollow(e){await this.deleteRequest(`playlists/${e}/followers`)}isFollowing(e,t){const s=this.paramsFor({ids:t});return this.getRequest(`playlists/${e}/followers/contains${s}`)}}class Ue extends u{savedShows(e,t){const s=this.paramsFor({limit:e,offset:t});return this.getRequest(`me/shows${s}`)}saveShows(e){const t=this.paramsFor({ids:e});return this.putRequest(`me/shows${t}`)}removeSavedShows(e,t){const s=this.paramsFor({ids:e,market:t});return this.deleteRequest(`me/shows${s}`)}hasSavedShow(e){const t=this.paramsFor({ids:e});return this.getRequest(`me/shows/contains${t}`)}}class Ie extends u{savedTracks(e,t,s){const n=this.paramsFor({limit:e,offset:t,market:s});return this.getRequest(`me/tracks${n}`)}async saveTracks(e){await this.putRequest("me/tracks",e)}async removeSavedTracks(e){await this.deleteRequest("me/tracks",e)}hasSavedTracks(e){const t=this.paramsFor({ids:e});return this.getRequest(`me/tracks/contains${t}`)}}class Pe{static get current(){return this.hasSubtleCrypto?window.crypto:this.tryLoadNodeWebCrypto()}static get hasSubtleCrypto(){return typeof window<"u"&&typeof window.crypto<"u"&&typeof window.crypto.subtle<"u"}static tryLoadNodeWebCrypto(){try{const{webcrypto:e}=require("crypto");return e}catch(e){throw e}}}class w{static async refreshCachedAccessToken(e,t){const s=await w.refreshToken(e,t.refresh_token);return w.toCachable(s)}static toCachable(e){return e.expires&&e.expires===-1?e:{...e,expires:this.calculateExpiry(e)}}static calculateExpiry(e){return Date.now()+e.expires_in*1e3}static async refreshToken(e,t){const s=new URLSearchParams;s.append("client_id",e),s.append("grant_type","refresh_token"),s.append("refresh_token",t);const n=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s}),r=await n.text();if(!n.ok)throw new Error(`Failed to refresh token: ${n.statusText}, ${r}`);return JSON.parse(r)}static generateCodeVerifier(e){let t="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0;n<e;n++)t+=s.charAt(Math.floor(Math.random()*s.length));return t}static async generateCodeChallenge(e){const t=new TextEncoder().encode(e),s=await Pe.current.subtle.digest("SHA-256",t),n=[...new Uint8Array(s)];return(typeof Buffer<"u"?Buffer.from(s).toString("base64"):btoa(String.fromCharCode.apply(null,n))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}}const v=class v{constructor(e,t,s=[]){o(this,"clientId");o(this,"clientSecret");o(this,"scopes");o(this,"configuration",null);this.clientId=e,this.clientSecret=t,this.scopes=s}get cache(){return this.configuration.cachingStrategy}setConfiguration(e){this.configuration=e}async getOrCreateAccessToken(){return await this.cache.getOrCreate(v.cacheKey,async()=>{const t=await this.getTokenFromApi();return w.toCachable(t)},async t=>{const s=await this.getTokenFromApi();return w.toCachable(s)})}async getAccessToken(){return await this.cache.get(v.cacheKey)}removeAccessToken(){this.cache.remove(v.cacheKey)}async getTokenFromApi(){const e={grant_type:"client_credentials",scope:this.scopes.join(" ")},t=Object.keys(e).map(p=>p+"="+e[p]).join("&"),s=typeof Buffer<"u",n=`${this.clientId}:${this.clientSecret}`,r=s?Buffer.from(n).toString("base64"):btoa(n),c=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Basic ${r}`},body:t});if(c.status!==200)throw new Error("Failed to get access token.");return await c.json()}};o(v,"cacheKey","spotify-sdk:ClientCredentialsStrategy:token");let E=v;const x=class x{constructor(e,t,s){o(this,"clientId");o(this,"redirectUri");o(this,"scopes");o(this,"configuration",null);this.clientId=e,this.redirectUri=t,this.scopes=s}get cache(){return this.configuration.cachingStrategy}setConfiguration(e){this.configuration=e}async getOrCreateAccessToken(){return await this.cache.getOrCreate(x.cacheKey,async()=>{const t=await this.redirectOrVerifyToken();return w.toCachable(t)},async t=>w.refreshCachedAccessToken(this.clientId,t))}async getAccessToken(){return await this.cache.get(x.cacheKey)}removeAccessToken(){this.cache.remove(x.cacheKey)}async redirectOrVerifyToken(){const e=new URLSearchParams(window.location.hash.substring(1)),t=e.get("access_token");if(t)return Promise.resolve({access_token:t,token_type:e.get("token_type")??"",expires_in:parseInt(e.get("expires_in")??"0"),refresh_token:e.get("refresh_token")??"",expires:Number(e.get("expires"))||0});var n=(this.scopes??[]).join(" ");const r=new URLSearchParams;r.append("client_id",this.clientId),r.append("response_type","token"),r.append("redirect_uri",this.redirectUri),r.append("scope",n);const c="https://accounts.spotify.com/authorize?"+r.toString();return this.configuration.redirectionStrategy.redirect(c),P}};o(x,"cacheKey","spotify-sdk:ImplicitGrantStrategy:token");let U=x;const S=class S{constructor(e,t,s){o(this,"clientId");o(this,"redirectUri");o(this,"scopes");o(this,"configuration",null);this.clientId=e,this.redirectUri=t,this.scopes=s}get cache(){return this.configuration.cachingStrategy}setConfiguration(e){this.configuration=e}async getOrCreateAccessToken(){return await this.cache.getOrCreate(S.cacheKey,async()=>{const t=await this.redirectOrVerifyToken();return w.toCachable(t)},async t=>w.refreshCachedAccessToken(this.clientId,t))}async getAccessToken(){return await this.cache.get(S.cacheKey)}removeAccessToken(){this.cache.remove(S.cacheKey)}async redirectOrVerifyToken(){const t=new URLSearchParams(window.location.search).get("code");if(t){const s=await this.verifyAndExchangeCode(t);return this.removeCodeFromUrl(),s}return this.redirectToSpotify(),P}async redirectToSpotify(){const e=w.generateCodeVerifier(128),t=await w.generateCodeChallenge(e),s={verifier:e,expiresOnAccess:!0};this.cache.setCacheItem("spotify-sdk:verifier",s);const n=await this.generateRedirectUrlForUser(this.scopes,t);await this.configuration.redirectionStrategy.redirect(n)}async verifyAndExchangeCode(e){const t=await this.cache.get("spotify-sdk:verifier"),s=t==null?void 0:t.verifier;if(!s)throw new Error("No verifier found in cache - can't validate query string callback parameters.");return await this.configuration.redirectionStrategy.onReturnFromRedirect(),await this.exchangeCodeForToken(e,s)}removeCodeFromUrl(){const e=new URL(window.location.href);e.searchParams.delete("code");const t=e.search?e.href:e.href.replace("?","");window.history.replaceState({},document.title,t)}async generateRedirectUrlForUser(e,t){const s=e.join(" "),n=new URLSearchParams;return n.append("client_id",this.clientId),n.append("response_type","code"),n.append("redirect_uri",this.redirectUri),n.append("scope",s),n.append("code_challenge_method","S256"),n.append("code_challenge",t),`https://accounts.spotify.com/authorize?${n.toString()}`}async exchangeCodeForToken(e,t){const s=new URLSearchParams;s.append("client_id",this.clientId),s.append("grant_type","authorization_code"),s.append("code",e),s.append("redirect_uri",this.redirectUri),s.append("code_verifier",t);const n=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:s}),r=await n.text();if(!n.ok)throw new Error(`Failed to exchange code for token: ${n.statusText}, ${r}`);return JSON.parse(r)}};o(S,"cacheKey","spotify-sdk:AuthorizationCodeWithPKCEStrategy:token");let T=S;class Be{async deserialize(e){const t=await e.text();return t.length>0?JSON.parse(t):null}}class De{async validateResponse(e){switch(e.status){case 401:throw new Error("Bad or expired token. This can happen if the user revoked a token or the access token has expired. You should re-authenticate the user.");case 403:const t=await e.text();throw new Error(`Bad OAuth request (wrong consumer key, bad nonce, expired timestamp...). Unfortunately, re-authenticating the user won't help here. Body: ${t}`);case 429:throw new Error("The app has exceeded its rate limits.");default:if(!e.status.toString().startsWith("20")){const s=await e.text();throw new Error(`Unrecognised response code: ${e.status} - ${e.statusText}. Body: ${s}`)}}}}class Me{async handleErrors(e){return!1}}class _e{async redirect(e){document.location=e.toString()}async onReturnFromRedirect(){}}class H{constructor(e,t=new Map,s=0,n=2*60*1e3){o(this,"storage");o(this,"updateFunctions");o(this,"autoRenewInterval");o(this,"autoRenewWindow");this.storage=e,this.updateFunctions=t,this.autoRenewInterval=s,this.autoRenewWindow=n,this.autoRenewInterval>0&&setInterval(()=>this.autoRenewRenewableItems(),this.autoRenewInterval)}async getOrCreate(e,t,s){s&&this.updateFunctions.set(e,s);const n=await this.get(e);if(n)return n;const r=await t();if(!r)throw new Error("Could not create cache item");return q(r)||this.setCacheItem(e,r),r}async get(e){let t=this.storage.get(e),s=t?JSON.parse(t):null;if(this.itemDueToExpire(s)&&this.updateFunctions.has(e)){const n=this.updateFunctions.get(e);await this.tryUpdateItem(e,s,n),t=this.storage.get(e),s=t?JSON.parse(t):null}return s?s.expires&&(s.expires===-1||s.expires<=Date.now())?(this.remove(e),null):(s.expiresOnAccess&&s.expiresOnAccess===!0&&this.remove(e),s):null}set(e,t,s){const n=Date.now()+s,r={...t,expires:n};this.setCacheItem(e,r)}setCacheItem(e,t){const s=JSON.stringify(t);this.storage.set(e,s)}remove(e){this.storage.remove(e)}itemDueToExpire(e){return!e||!e.expires?!1:e.expires-Date.now()<this.autoRenewWindow}async autoRenewRenewableItems(){this.updateFunctions.forEach(async(e,t)=>{const s=await this.get(t);s&&e&&this.itemDueToExpire(s)&&await this.tryUpdateItem(t,s,e)})}async tryUpdateItem(e,t,s){try{const n=await s(t);n&&this.setCacheItem(e,n)}catch(n){console.error(n)}}}class Oe extends H{constructor(){super(new je)}}class je{get(e){return localStorage.getItem(e)}set(e,t){localStorage.setItem(e,t)}remove(e){localStorage.removeItem(e)}}class ze extends H{constructor(){super(new Le)}}class Le{constructor(){o(this,"cache",new Map)}get(e){return this.cache.get(e)??null}set(e,t){this.cache.set(e,t)}remove(e){this.cache.delete(e)}}class Ne{constructor(e,t,s){o(this,"clientId");o(this,"accessToken");o(this,"refreshTokenAction");this.clientId=e,this.accessToken=t,this.refreshTokenAction=s||w.refreshCachedAccessToken,this.accessToken.expires||(this.accessToken.expires=w.calculateExpiry(this.accessToken))}setConfiguration(e){}async getOrCreateAccessToken(){if(this.accessToken.expires&&this.accessToken.expires<=Date.now()){const e=await this.refreshTokenAction(this.clientId,this.accessToken);this.accessToken=e}return this.accessToken}async getAccessToken(){return this.accessToken}removeAccessToken(){this.accessToken={access_token:"",token_type:"",expires_in:0,refresh_token:"",expires:0}}}const R=class R{constructor(e,t){o(this,"sdkConfig");o(this,"authenticationStrategy");o(this,"albums");o(this,"artists");o(this,"audiobooks");o(this,"browse");o(this,"chapters");o(this,"episodes");o(this,"recommendations");o(this,"markets");o(this,"player");o(this,"playlists");o(this,"shows");o(this,"tracks");o(this,"users");o(this,"search");o(this,"currentUser");this.sdkConfig=this.initializeSdk(t),this.albums=new de(this),this.artists=new me(this),this.audiobooks=new ge(this),this.browse=new ye(this),this.chapters=new fe(this),this.episodes=new we(this),this.recommendations=new ke(this),this.markets=new be(this),this.player=new Re(this),this.playlists=new Ce(this),this.shows=new xe(this),this.tracks=new Se(this),this.users=new qe(this),this.currentUser=new Te(this);const s=new ve(this);this.search=s.execute.bind(s),this.authenticationStrategy=e,this.authenticationStrategy.setConfiguration(this.sdkConfig)}async makeRequest(e,t,s=void 0,n=void 0){try{const r=await this.authenticationStrategy.getOrCreateAccessToken();if(q(r))return console.warn("No access token found, authenticating now."),null;const c=r==null?void 0:r.access_token,d=R.rootUrl+t,p={method:e,headers:{Authorization:`Bearer ${c}`,"Content-Type":n??"application/json"},body:s?typeof s=="string"?s:JSON.stringify(s):void 0};this.sdkConfig.beforeRequest(d,p);const h=await this.sdkConfig.fetch(d,p);return this.sdkConfig.afterRequest(d,p,h),h.status===204?null:(await this.sdkConfig.responseValidator.validateResponse(h),this.sdkConfig.deserializer.deserialize(h))}catch(r){if(!await this.sdkConfig.errorHandler.handleErrors(r))throw r;return null}}initializeSdk(e){const t=typeof window<"u";return{...{fetch:(n,r)=>fetch(n,r),beforeRequest:(n,r)=>{},afterRequest:(n,r,c)=>{},deserializer:new Be,responseValidator:new De,errorHandler:new Me,redirectionStrategy:new _e,cachingStrategy:t?new Oe:new ze},...e}}switchAuthenticationStrategy(e){this.authenticationStrategy=e,this.authenticationStrategy.setConfiguration(this.sdkConfig),this.authenticationStrategy.getOrCreateAccessToken()}async authenticate(){const e=await this.authenticationStrategy.getOrCreateAccessToken();return{authenticated:e.expires>Date.now()&&!q(e),accessToken:e}}async getAccessToken(){return this.authenticationStrategy.getAccessToken()}logOut(){this.authenticationStrategy.removeAccessToken()}static withUserAuthorization(e,t,s=[],n){const r=new T(e,t,s);return new R(r,n)}static withClientCredentials(e,t,s=[],n){const r=new E(e,t,s);return new R(r,n)}static withImplicitGrant(e,t,s=[],n){const r=new U(e,t,s);return new R(r,n)}static withAccessToken(e,t,s){const n=new Ne(e,t);return new R(n,s)}static async performUserAuthorization(e,t,s,n,r){const c=new T(e,t,s),p=await new R(c,r).authenticationStrategy.getOrCreateAccessToken();return q(p)||(typeof n=="string"?(console.log("Posting access token to postback URL."),await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})):await n(p)),{authenticated:p.expires>Date.now()&&!q(p),accessToken:p}}};o(R,"rootUrl","https://api.spotify.com/v1/");let I=R;const j=I.withClientCredentials("7ca5c141427a4fc7abc915f40e945285","cc7f4b4dedcc4647bdc6b1fb21a7611e"),z={display:"flex",flexDirection:"column",alignItems:"center",minWidth:"50px",maxWidth:"100px",borderRadius:"var(--pico-border-radius)",backgroundColor:"rgba(255, 255, 255, 0.1)"};function Ve(i){const[e,t]=b(""),[s,n]=b(!1),[r,c]=b([]);async function d(){c([]),n(!0);const h=await j.search(e,["track"],void 0,10),l={};for(const y of h.tracks.items)l[y.id]={id:G(),nome:y.name,autor:y.artists[0].name,temVS:!1,bpm:0,tom:"C",coverUrl:y.album.images[0].url};const k=Object.keys(l).map(y=>y),g=await j.tracks.audioFeatures(k);for(const y of g)l[y.id].bpm=Math.round(y.tempo),l[y.id].tom=y.key==-1?"?":W[y.key];c(Object.values(l)),n(!1)}function p(h){h.nome=h.nome+" - "+h.autor,i.onClose(h)}return a("dialog",{open:i.isOpen,children:a("article",{children:[a("h3",{children:[a(N,{size:32})," Buscar no Spotify"]}),a("form",{role:"search",children:[a("input",{type:"search",placeholder:"Busca",value:e,disabled:s,onChange:f(h=>t(h))}),a("button",{type:"button",disabled:s,onClick:d,children:"Buscar"})]}),a("div",{style:{overflowY:"auto",maxHeight:"500px"},children:[r.length===0&&!s&&a(V,{icon:"Inbox",title:"Nada Encontrado"}),s&&a("article",{"aria-busy":!0}),a("ul",{style:{padding:0},children:r.map(h=>a("div",{class:"list-tile",onClick:()=>p(h),children:[a("img",{src:h.coverUrl,alt:h.nome}),a("div",{class:"content",children:[a("h4",{children:h.nome}),a("small",{children:h.autor})]}),a("div",{class:"trailing",children:[a("div",{style:z,children:[a("small",{style:"color: var(--pico-h6-color)",children:"Tom"}),a("h5",{style:{margin:0},children:h.tom})]}),a("div",{style:z,children:[a("small",{style:"color: var(--pico-h6-color)",children:"BPM"}),a("h5",{style:{margin:0},children:h.bpm})]})]})]}))})]}),a("footer",{children:a("button",{class:"secondary",onClick:()=>i.onClose(),children:"Cancelar"})})]})})}const W=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function Ge(i){const[e,t]=b(!1),{musicas:s,setMusicas:n}=i,r=ae();function c(){n([...s,{id:G(),nome:"Nome da Música",temVS:!1,bpm:120,tom:"C"}])}function d(l){n(s.map(k=>k.id===l.id?l:k))}function p(l){n(s.filter(k=>k.id!==l))}function h(l){l&&n([...s,l]),t(!1)}return a($,{children:[a("h3",{children:"Músicas"}),a("div",{class:"grid",children:[a("button",{type:"button",onClick:c,children:[a(ne,{size:32})," Adicionar"]}),a("button",{type:"button",class:"secondary",onClick:()=>t(!0),children:[a(N,{size:32})," Buscar no Spotify"]})]}),s.length===0&&a(V,{icon:"Inbox",title:"Nenhuma música adicionada"}),s.length>0&&a("div",{class:"overflow-auto",children:a("table",{class:"striped",children:[a("thead",{children:a("tr",{children:[a("th",{children:"Nome"}),a("th",{children:"Tem VS?"}),a("th",{children:"Tom"}),a("th",{children:"BPM"}),a("th",{children:"Ações"})]})}),a("tbody",{children:s.map((l,k)=>a("tr",{children:[a("td",{children:a("input",{class:"input-in-table",style:{minWidth:r?"240px":null},type:"text",value:l.nome,onChange:f(g=>{l.nome=g,d(l)})})}),a("td",{children:a("input",{class:"input-in-table",type:"checkbox",checked:l.temVS,onChange:f(g=>{l.temVS=g,d(l)})})}),a("td",{children:a("select",{class:"input-in-table",style:{minWidth:r?"100px":null},value:l.tom,onChange:f(g=>{l.tom=g,d(l)}),children:W.map(g=>a("option",{value:g,children:g},g))})}),a("td",{children:a("input",{class:"input-in-table",style:{minWidth:r?"100px":null},type:"number",value:l.bpm,min:40,max:240,onChange:f(g=>{l.bpm=parseInt(g),d(l)})})}),a("td",{children:a("div",{class:"icon-button",onClick:()=>p(l.id),"data-tooltip":"Deletar",children:a(L,{size:24,color:"red"})})})]},"mus"+k))})]})}),a(Ve,{isOpen:e,onClose:h})]})}function He(){const[i,e]=b({lead:"",backs:[],bateria:"",baixo:"",teclado:"",guitarra:"",violao:"",dm:"",tecnicosAudio:[]}),[t,s]=b([]),[n,r]=b([]),[c,d]=b(""),[p,h]=b(new Date),[l,k]=M("setlists",[]),[g,y]=M("_sl",void 0),[J,B]=b(!1);async function K(){B(!0);const C={nome:c,data:p,musicas:t,equipe:i,paleta:n};k([...l,C]),y(C),window.open("/pdf.html","_blank"),B(!1)}return a($,{children:a("main",{class:"container",style:"margin-top: 2em",children:[a("h1",{children:"📄 Gerador de Setlists"}),a("hr",{}),a("div",{class:"grid",children:[a("label",{children:["Nome do Setlist",a("input",{type:"text",value:c,onChange:f(C=>d(C.trim())),"aria-invalid":!c||c.length<3,tabIndex:0})]}),a("label",{children:["Data do Setlist",a("input",{type:"date",value:p.toISOString().split("T")[0],onChange:f(C=>h(new Date(C)))})]})]}),a("br",{}),a("br",{}),a(Ge,{musicas:t,setMusicas:s}),a("hr",{}),a(ce,{equipe:i,setEquipe:e}),a("hr",{}),a(re,{paletas:n,setPaletas:r}),a("hr",{}),a("div",{role:"group",children:a("button",{"aria-busy":J,onClick:K,children:[a(ie,{size:32})," Gerar Setlist"]})})]})})}oe(a(He,{}),document.getElementById("app"));
